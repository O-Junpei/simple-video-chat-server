FROM ubuntu:16.04

RUN apt-get update && apt-get install -y \
  git \
  vim \
  wget \
  curl
RUN /bin/bash -c "$(wget -qO- https://apt.vapor.sh)"
RUN apt-get install -y \
  swift \
  vapor

RUN mkdir /vapor
COPY Package.swift /vapor/Package.swift
COPY Package.resolved /vapor/Package.resolved
COPY Public /vapor/Public
COPY Resources /vapor/Resources
COPY Sources /vapor/Sources
COPY Tests /vapor/Tests

WORKDIR /vapor
RUN swift build
RUN vapor build

EXPOSE 8080

# chmod +x startup.sh
COPY /Dockerfile/startup-without-nginx.sh /startup.sh
ENTRYPOINT ["/startup.sh"]
